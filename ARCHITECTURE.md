# ğŸ—ï¸ Arquitetura StudyCycle - Diagrama e ExplicaÃ§Ã£o

## ğŸ“Š Diagrama Visual da Arquitetura

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          STUDYCYCLE MONOREPO                                  â”‚
â”‚                      (Turborepo - npm workspaces)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            CAMADA DE APRESENTAÃ‡ÃƒO                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Web (React)       â”‚               â”‚  Mobile (RN)        â”‚              â”‚
â”‚  â”‚   /apps/web         â”‚               â”‚  /apps/mobile       â”‚              â”‚
â”‚  â”‚                     â”‚               â”‚                     â”‚              â”‚
â”‚  â”‚ â€¢ Vite + React 18   â”‚               â”‚ â€¢ Expo              â”‚              â”‚
â”‚  â”‚ â€¢ TypeScript        â”‚               â”‚ â€¢ TypeScript        â”‚              â”‚
â”‚  â”‚ â€¢ Tailwind CSS      â”‚               â”‚ â€¢ Tailwind RN       â”‚              â”‚
â”‚  â”‚ â€¢ React Query       â”‚               â”‚ â€¢ React Query       â”‚              â”‚
â”‚  â”‚ â€¢ Auth Context      â”‚               â”‚ â€¢ SQLite (local)    â”‚              â”‚
â”‚  â”‚                     â”‚               â”‚ â€¢ Offline Storage   â”‚              â”‚
â”‚  â”‚ http://localhost:   â”‚               â”‚ http://localhost:   â”‚              â”‚
â”‚  â”‚       3000          â”‚               â”‚       8081          â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚             â”‚                                     â”‚                          â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                   â”‚                                          â”‚
â”‚                          REST API com JWT                                    â”‚
â”‚                                   â”‚                                          â”‚
â”‚                                   â–¼                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CAMADA DE LÃ“GICA DE NEGÃ“CIO                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚              PACKAGES COMPARTILHADOS                         â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚                                                              â”‚             â”‚
â”‚  â”‚  @studycycle/core        @studycycle/ui   @studycycle/db-sync
â”‚  â”‚  /packages/core          /packages/ui     /packages/db-sync â”‚             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚             â”‚
â”‚  â”‚  â”‚ ValidaÃ§Ãµes   â”‚        â”‚ Tokens   â”‚     â”‚  Sync Logic   â”‚ â”‚             â”‚
â”‚  â”‚  â”‚ Schemas (Zod)â”‚        â”‚ Design   â”‚     â”‚  Queue Mgmt   â”‚ â”‚             â”‚
â”‚  â”‚  â”‚ Types TS     â”‚        â”‚ Colors   â”‚     â”‚  Conflict Res â”‚ â”‚             â”‚
â”‚  â”‚  â”‚ Utils        â”‚        â”‚ Font     â”‚     â”‚  Validation   â”‚ â”‚             â”‚
â”‚  â”‚  â”‚ Hooks        â”‚        â”‚ Components    â”‚ Response Build  â”‚ â”‚             â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ ReutilizÃ¡veis â”‚â”€â”˜               â”‚ â”‚             â”‚
â”‚  â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚             â”‚
â”‚  â”‚                                                              â”‚             â”‚
â”‚  â”‚  USADO POR:                                                  â”‚             â”‚
â”‚  â”‚  â€¢ /apps/web                                                â”‚             â”‚
â”‚  â”‚  â€¢ /apps/mobile                                             â”‚             â”‚
â”‚  â”‚  â€¢ /apps/api                                                â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            CAMADA DE API                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚           API (Node.js/Express)                          â”‚                â”‚
â”‚  â”‚           /apps/api                                      â”‚                â”‚
â”‚  â”‚  http://localhost:3001                                   â”‚                â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
â”‚  â”‚                                                          â”‚                â”‚
â”‚  â”‚  ROTAS PRINCIPAIS:                                       â”‚                â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                â”‚
â”‚  â”‚  â”‚ POST /api/auth/login         â†’ JWT Token           â”‚ â”‚                â”‚
â”‚  â”‚  â”‚ POST /api/auth/register      â†’ Novo usuÃ¡rio        â”‚ â”‚                â”‚
â”‚  â”‚  â”‚ POST /api/auth/refresh       â†’ Renovar token       â”‚ â”‚                â”‚
â”‚  â”‚  â”‚                                                     â”‚ â”‚                â”‚
â”‚  â”‚  â”‚ CRUD /api/study-cycles/*     â†’ Ciclos de estudo    â”‚ â”‚                â”‚
â”‚  â”‚  â”‚ CRUD /api/subjects/*         â†’ Disciplinas         â”‚ â”‚                â”‚
â”‚  â”‚  â”‚ CRUD /api/courses/*          â†’ Aulas               â”‚ â”‚                â”‚
â”‚  â”‚  â”‚                                                     â”‚ â”‚                â”‚
â”‚  â”‚  â”‚ POST /api/sync               â†’ Sincronizar batch   â”‚ â”‚                â”‚
â”‚  â”‚  â”‚ GET  /api/sync/status        â†’ Status do sync      â”‚ â”‚                â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚
â”‚  â”‚                                                          â”‚                â”‚
â”‚  â”‚  RECURSOS:                                               â”‚                â”‚
â”‚  â”‚  â€¢ Express 4.x                                           â”‚                â”‚
â”‚  â”‚  â€¢ JWT Authentication                                    â”‚                â”‚
â”‚  â”‚  â€¢ Rate Limiting                                         â”‚                â”‚
â”‚  â”‚  â€¢ CORS                                                  â”‚                â”‚
â”‚  â”‚  â€¢ Helmet (security headers)                             â”‚                â”‚
â”‚  â”‚  â€¢ ValidaÃ§Ã£o com Zod                                     â”‚                â”‚
â”‚  â”‚                                                          â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CAMADA DE PERSISTÃŠNCIA                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  POSTGRESQL (Docker)             â”‚     â”‚   SQLITE (Mobile - Local)    â”‚  â”‚
â”‚  â”‚  postgres:16-alpine              â”‚     â”‚   Armazenamento Local        â”‚  â”‚
â”‚  â”‚  localhost:5432                  â”‚     â”‚   Offline-First              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                  â”‚     â”‚                              â”‚  â”‚
â”‚  â”‚  TABELAS:                        â”‚     â”‚  TABELAS:                    â”‚  â”‚
â”‚  â”‚  â€¢ users                         â”‚     â”‚  â€¢ study_cycles_local        â”‚  â”‚
â”‚  â”‚  â€¢ study_cycles                 â”‚     â”‚  â€¢ subjects_local            â”‚  â”‚
â”‚  â”‚  â€¢ subjects                     â”‚     â”‚  â€¢ courses_local             â”‚  â”‚
â”‚  â”‚  â€¢ courses                      â”‚     â”‚  â€¢ sync_queue                â”‚  â”‚
â”‚  â”‚  â€¢ sync_logs                    â”‚     â”‚  â€¢ offline_changes           â”‚  â”‚
â”‚  â”‚  â€¢ sync_queue                   â”‚     â”‚  â€¢ conflict_log              â”‚  â”‚
â”‚  â”‚                                  â”‚     â”‚                              â”‚  â”‚
â”‚  â”‚  CARACTERÃSTICAS:                â”‚     â”‚  CARACTERÃSTICAS:            â”‚  â”‚
â”‚  â”‚  â€¢ Dados centralizados          â”‚     â”‚  â€¢ Snapshot local            â”‚  â”‚
â”‚  â”‚  â€¢ Fonte de verdade             â”‚     â”‚  â€¢ Trabalha offline          â”‚  â”‚
â”‚  â”‚  â€¢ HistÃ³rico de sync            â”‚     â”‚  â€¢ Sincroniza quando online  â”‚  â”‚
â”‚  â”‚  â€¢ Controle de conflitos        â”‚     â”‚  â€¢ AutomÃ¡tico (background)   â”‚  â”‚
â”‚  â”‚                                  â”‚     â”‚                              â”‚  â”‚
â”‚  â”‚  PGAdmin UI:                     â”‚     â”‚  Acesso via React Native API â”‚  â”‚
â”‚  â”‚  http://localhost:5050          â”‚     â”‚  (@react-native-community)   â”‚  â”‚
â”‚  â”‚                                  â”‚     â”‚                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SINCRONIZAÃ‡ÃƒO OFFLINE/ONLINE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  1ï¸âƒ£  OFFLINE (Mobile)                                                        â”‚
â”‚  â”œâ”€ UsuÃ¡rio cria/edita ciclo de estudo                                      â”‚
â”‚  â”œâ”€ App grava em SQLite localmente                                          â”‚
â”‚  â”œâ”€ MudanÃ§a adicionada Ã  fila de sincronizaÃ§Ã£o                              â”‚
â”‚  â””â”€ App continua funcionando sem internet                                   â”‚
â”‚                                                                               â”‚
â”‚  2ï¸âƒ£  DETECÃ‡ÃƒO DE CONEXÃƒO                                                    â”‚
â”‚  â”œâ”€ App detecta mudanÃ§a de conectividade                                    â”‚
â”‚  â”œâ”€ Navigator.onLine muda de false para true                               â”‚
â”‚  â””â”€ Trigger sync automÃ¡tico                                                 â”‚
â”‚                                                                               â”‚
â”‚  3ï¸âƒ£  SINCRONIZAÃ‡ÃƒO (Mobile â†’ API)                                           â”‚
â”‚  â”œâ”€ Agrupa mudanÃ§as em SyncBatch                                            â”‚
â”‚  â”œâ”€ Envia POST /api/sync com:                                               â”‚
â”‚  â”‚  {                                                                       â”‚
â”‚  â”‚    userId: "uuid",                                                       â”‚
â”‚  â”‚    clientId: "device-id",                                                â”‚
â”‚  â”‚    items: [                                                              â”‚
â”‚  â”‚      {                                                                   â”‚
â”‚  â”‚        entityType: "study_cycle",                                        â”‚
â”‚  â”‚        entityId: "uuid",                                                 â”‚
â”‚  â”‚        operation: "create",                                              â”‚
â”‚  â”‚        data: { name: "...", startDate: "..." },                          â”‚
â”‚  â”‚        timestamp: 1704067200000                                          â”‚
â”‚  â”‚      }                                                                   â”‚
â”‚  â”‚    ]                                                                     â”‚
â”‚  â”‚  }                                                                       â”‚
â”‚  â””â”€ Aguarda resposta                                                        â”‚
â”‚                                                                               â”‚
â”‚  4ï¸âƒ£  PROCESSAMENTO (API â†’ PostgreSQL)                                       â”‚
â”‚  â”œâ”€ API valida batch                                                        â”‚
â”‚  â”œâ”€ Para cada item:                                                         â”‚
â”‚  â”‚  â”œâ”€ Verifica se entidade existe                                          â”‚
â”‚  â”‚  â”œâ”€ Resolve conflitos (Last-Write-Wins)                                  â”‚
â”‚  â”‚  â”œâ”€ Aplica mudanÃ§a no PostgreSQL                                         â”‚
â”‚  â”‚  â””â”€ Registra em sync_logs                                                â”‚
â”‚  â”œâ”€ Retorna resultado                                                       â”‚
â”‚  â””â”€ Log de sincronizaÃ§Ã£o                                                    â”‚
â”‚                                                                               â”‚
â”‚  5ï¸âƒ£  SINCRONIZAÃ‡ÃƒO (API â†’ Mobile)                                           â”‚
â”‚  â”œâ”€ API retorna:                                                            â”‚
â”‚  â”‚  {                                                                       â”‚
â”‚  â”‚    success: true,                                                        â”‚
â”‚  â”‚    batchId: "uuid",                                                      â”‚
â”‚  â”‚    syncedItems: [                                                        â”‚
â”‚  â”‚      {                                                                   â”‚
â”‚  â”‚        entityId: "uuid",                                                 â”‚
â”‚  â”‚        operation: "create",                                              â”‚
â”‚  â”‚        status: "success",                                                â”‚
â”‚  â”‚        serverId: "uuid-novo"                                             â”‚
â”‚  â”‚      }                                                                   â”‚
â”‚  â”‚    ],                                                                    â”‚
â”‚  â”‚    serverData: [                                                         â”‚
â”‚  â”‚      {                                                                   â”‚
â”‚  â”‚        entityType: "study_cycle",                                        â”‚
â”‚  â”‚        entityId: "uuid",                                                 â”‚
â”‚  â”‚        data: { ... dados completos ... }                                 â”‚
â”‚  â”‚      }                                                                   â”‚
â”‚  â”‚    ]                                                                     â”‚
â”‚  â”‚  }                                                                       â”‚
â”‚  â”œâ”€ Mobile atualiza SQLite com dados do servidor                            â”‚
â”‚  â”œâ”€ Remove itens da fila de sync                                            â”‚
â”‚  â””â”€ Notifica usuÃ¡rio (opcional)                                             â”‚
â”‚                                                                               â”‚
â”‚  âš ï¸  TRATAMENTO DE CONFLITOS                                                |
â”‚  â”œâ”€ Last-Write-Wins (LWW)                                                   â”‚
â”‚  â”‚  â””â”€ Timestamp mais recente prevalece                                     â”‚
â”‚  â”œâ”€ Se deletado no servidor mas editado mobile                              â”‚
â”‚  â”‚  â””â”€ API marca como conflito                                              â”‚
â”‚  â””â”€ UsuÃ¡rio resolve manualmente se necessÃ¡rio                               â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Fluxo de AutenticaÃ§Ã£o

```
CLIENTE                          API                           POSTGRESQL
   â”‚                              â”‚                                â”‚
   â”œâ”€ POST /auth/login â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚                                â”‚
   â”‚  {email, password}           â”‚                                â”‚
   â”‚                              â”œâ”€ Hash password com bcrypt      â”‚
   â”‚                              â”œâ”€ Query users table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
   â”‚                              â”‚                                â”‚
   â”‚                              â”‚ â† UsuÃ¡rio encontrado           â”‚
   â”‚                              â”‚                                â”‚
   â”‚                              â”œâ”€ Gera JWT token               â”‚
   â”‚ â† {token, refreshToken} â”€â”€â”€â”€â”€â”¤                                â”‚
   â”‚   + user data                â”‚                                â”‚
   â”‚                              â”‚                                â”‚
   â”œâ”€ GET /api/study-cycles â”€â”€â”€â”€â”€â†’â”‚ Valida JWT                      â”‚
   â”‚  Header: Authorization       â”‚ â”œâ”€ Verifica signature          â”‚
   â”‚          Bearer <token>      â”‚ â”œâ”€ Verifica expiraÃ§Ã£o          â”‚
   â”‚                              â”‚ â”œâ”€ Extrai userId               â”‚
   â”‚                              â”‚                                â”‚
   â”‚                              â”œâ”€ Query baseado em userId â”€â”€â†’  â”‚
   â”‚                              â”‚                                â”‚
   â”‚                              â”‚ â† Dados do usuÃ¡rio             â”‚
   â”‚ â† Dados estruturados â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
   â”‚                              â”‚                                â”‚
   â””â”€ POST /auth/refresh â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ Valida refresh token          â”‚
      {refreshToken}              â”œâ”€ Gera novo JWT               â”‚
                                  â”‚                                â”‚
      â† {token, refreshToken} â”€â”€â”€â”€â”¤                                â”‚
```

## ğŸš€ Fluxo de Desenvolvimento

```
DESENVOLVIMENTO                   PRODUÃ‡ÃƒO
   â”‚                                â”‚
   npm install â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
   npm run dev:api      â”‚           â”‚
   npm run dev:web      â”‚           npm run build
   npm run dev:mobile   â”‚           â”‚
   â”‚                    â”‚           â”‚
   Turbo Cache          â”‚      Docker Image
   Watchers             â”‚      Container Registry
   Hot Reload           â”‚           â”‚
   â”‚                    â”‚           â”‚
   http://localhost:    â”‚      kubernetes/
   3000 (web)           â”‚      docker-compose
   8081 (mobile)        â”‚           â”‚
   3001 (api)           â”‚      Production Server
   â”‚                    â”‚           â”‚
   npm run lint         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ CI/CD Pipeline
   npm run type-check                â”‚
   npm test                          â”‚
```

## ğŸ“¦ DependÃªncias Compartilhadas

```
@studycycle/core
â”œâ”€â”€ zod              (ValidaÃ§Ã£o)
â””â”€â”€ Usada por: web, mobile, api

@studycycle/ui
â”œâ”€â”€ react            (Web)
â”œâ”€â”€ react-native     (Mobile)
â”œâ”€â”€ clsx
â”œâ”€â”€ tailwind-merge
â””â”€â”€ Usada por: web, mobile

@studycycle/db-sync
â”œâ”€â”€ zod              (ValidaÃ§Ã£o)
â”œâ”€â”€ uuid             (ID generation)
â””â”€â”€ Usada por: web, mobile, api

@studycycle/api
â”œâ”€â”€ express
â”œâ”€â”€ pg
â”œâ”€â”€ drizzle-orm
â”œâ”€â”€ @studycycle/core
â”œâ”€â”€ @studycycle/db-sync
â””â”€â”€ NÃ£o Ã© package compartilhado, Ã© app

DependÃªncias Externas Comuns
â”œâ”€â”€ @tanstack/react-query (Data fetching - web, mobile)
â”œâ”€â”€ typescript (CompilaÃ§Ã£o)
â”œâ”€â”€ eslint (Linting)
â””â”€â”€ prettier (Formatting)
```

## ğŸ’¾ Model de Dados

```
USERS (AutenticaÃ§Ã£o)
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ email (UNIQUE)
â”œâ”€â”€ password (bcrypt)
â”œâ”€â”€ firstName, lastName
â”œâ”€â”€ avatar (URL)
â””â”€â”€ timestamps

    â†“ (1:N)

STUDY_CYCLES (Ciclos de Estudo)
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ userId (FK â†’ users)
â”œâ”€â”€ name, description
â”œâ”€â”€ startDate, endDate
â”œâ”€â”€ isActive
â””â”€â”€ timestamps

    â†“ (1:N)

SUBJECTS (Disciplinas)
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ studyCycleId (FK)
â”œâ”€â”€ name, code, credits
â”œâ”€â”€ description
â”œâ”€â”€ color (hex)
â””â”€â”€ timestamps

    â†“ (1:N)

COURSES (Aulas/Classes)
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ subjectId (FK)
â”œâ”€â”€ name, teacher
â”œâ”€â”€ schedule, room
â””â”€â”€ timestamps

SYNC_LOGS (HistÃ³rico)
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ userId (FK)
â”œâ”€â”€ entityType, entityId
â”œâ”€â”€ operation (create/update/delete)
â”œâ”€â”€ changes (JSONB)
â”œâ”€â”€ synced, syncedAt
â””â”€â”€ timestamps

SYNC_QUEUE (Fila)
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ userId (FK)
â”œâ”€â”€ payload (JSONB)
â”œâ”€â”€ retries
â”œâ”€â”€ lastError
â””â”€â”€ createdAt
```

---

**ConstruÃ­do com TypeScript, Turborepo, Express, React, React Native e PostgreSQL**
